<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>プレイヤーのスキンをpngで保存</title>
    <link rel="stylesheet" href="css/article.css">

    <script src="highlight/highlight.min.js"></script>
    <link rel="stylesheet"
          href="highlight/styles/idea.min.css">
    <script>hljs.highlightAll();</script>
</head>
<body>
<p>プレイヤーのスキンをpngで保存</p>
<pre><code class="language-php">$player = ...;
$skin_raw = $player-&gt;getSkin()-&gt;getSkinData();

$height = 64;
$width = 64;
switch (strlen($skin_raw)) {
    case 64 * 32 * 4:
        $height = 32;
        $width = 64;
        break;
    case 64 * 64 * 4:
        $height = 64;
        $width = 64;
        break;
    case 128 * 64 * 4:
        $height = 64;
        $width = 128;
        break;
    case 128 * 128 * 4:
        $height = 128;
        $width = 128;
        break;
}

$img = imagecreatetruecolor($width, $height);
imagealphablending($img, false);
imagesavealpha($img, true);

$index = 0;
for ($y = 0; $y &lt; $height; ++$y) {
    for ($x = 0; $x &lt; $width; ++$x) {
        $list = substr($skin_raw, $index, 4);
        $r = ord($list[0]);
        $g = ord($list[1]);
        $b = ord($list[2]);
        $a = 127 - (ord($list[3]) &gt;&gt; 1);
        $index += 4;
        $color = imagecolorallocatealpha($img, $r, $g, $b, $a);
        imagesetpixel($img, $x, $y, $color);
    }
}

imagepng($img, $this-&gt;getDataFolder() . $player-&gt;getName() . ".png");
imagedestroy($img);
</code></pre>

</body>
</html>
  